<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–µ–∫—Å–∞ –¢—Ä–∞—Ö–∞—Ä—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      body { font-family: sans-serif; background: #f3e8ff; transition: background 0.3s, color 0.3s; }
      .card { background: #fff; border-radius: 16px; box-shadow: 0 2px 8px #0001; margin: 16px 0; padding: 24px; transition: background 0.3s, color 0.3s; }
      .button { padding: 10px 20px; border-radius: 8px; border: 1px solid #ccc; background: #f3f3f3; cursor: pointer; margin: 4px; transition: background 0.3s, color 0.3s; }
      .button-main { background: linear-gradient(90deg, #a78bfa, #f472b6); color: #fff; font-weight: bold; }
      .progress { width: 100%; height: 16px; border-radius: 8px; background: #eee; overflow: hidden; margin: 8px 0; }
      .progress-bar { height: 100%; background: linear-gradient(90deg, #a78bfa, #f472b6); }
      .emoji { font-size: 2em; }
      .slider-label { display: flex; justify-content: space-between; align-items: center; }
      .slider { width: 100%; }
      .section { margin-bottom: 16px; }
      /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ */
      .dark-theme { background: #1a0b2e !important; color: #e0c3fc !important; }
      .dark-theme .card { background: #2d1853 !important; color: #e0c3fc !important; }
      .dark-theme .button { background: #3b2170 !important; color: #e0c3fc !important; border-color: #a78bfa !important; }
      .dark-theme .button-main { background: linear-gradient(90deg, #7c3aed, #a21caf) !important; color: #fff !important; }
      .dark-theme .progress { background: #3b2170 !important; }
      .dark-theme .progress-bar { background: linear-gradient(90deg, #a78bfa, #7c3aed); }
      .dark-theme .emoji { color: #a78bfa; }
      .dark-theme .result-cell { background: #3b2170 !important; color: #e0c3fc !important; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect, useCallback, useMemo } = React;

      // Telegram WebApp integration
      const tg = typeof window !== 'undefined' && window.Telegram?.WebApp;

      function SliderItem({ label, value, max, onChange }) {
        const [isChanging, setIsChanging] = useState(false);
        const timeoutRef = React.useRef();

        const handleChange = (e) => {
          if (timeoutRef.current) clearTimeout(timeoutRef.current);
          setIsChanging(true);
          onChange(Number(e.target.value));
          if (tg && tg.HapticFeedback) tg.HapticFeedback.selectionChanged();
          timeoutRef.current = setTimeout(() => setIsChanging(false), 150);
        };

        useEffect(() => () => { if (timeoutRef.current) clearTimeout(timeoutRef.current); }, []);

        const formatValue = (num) => num % 1 === 0 ? num.toString() : num.toFixed(1);

        return (
          <div className="section">
            <div className="slider-label">
              <label>{label}</label>
              <span style={{fontWeight:'bold'}}>{formatValue(value)}/{max}</span>
            </div>
            <input
              type="range"
              min={0}
              max={max}
              step={0.5}
              value={value}
              onChange={handleChange}
              className="slider"
            />
          </div>
        );
      }

      function App() {
        const [currentPage, setCurrentPage] = useState('home');
        const [totalParticipants, setTotalParticipants] = useState(1);
        const [currentParticipant, setCurrentParticipant] = useState(1);
        const [results, setResults] = useState([]);
        const [theme, setTheme] = useState('light');
        const [count, setCount] = useState(1);
        const [showAverage, setShowAverage] = useState(false);
        const [toastMessage, setToastMessage] = useState(null);

        const [criteria, setCriteria] = useState({
          face: 0, body: 0, height: 0, hair: 0, skin: 0, smile: 0,
          muscles: 0, endurance: 0, flexibility: 0, posture: 0,
          confidence: 0, communication: 0, humor: 0, charismaEnergy: 0,
          kindness: 0, honesty: 0, empathy: 0, reliability: 0,
          fitness: 0, smell: 0, style: 0, status: 0,
        });

        const [expandedSections, setExpandedSections] = useState({
          appearance: false, physical: false, charisma: false, character: false,
        });

        useEffect(() => {
          if (tg) {
            tg.ready();
            tg.expand();
            tg.enableClosingConfirmation();
            const colorScheme = tg.colorScheme || 'light';
            setTheme(colorScheme);
            tg.setHeaderColor(colorScheme === 'dark' ? '#1a0b2e' : '#fdf4ff');
            tg.setBackgroundColor(colorScheme === 'dark' ? '#1a0b2e' : '#fdf4ff');
          }
        }, []);

        useEffect(() => {
          if (toastMessage) {
            const timer = setTimeout(() => setToastMessage(null), 3000);
            return () => clearTimeout(timer);
          }
        }, [toastMessage]);

        const showToast = (message) => {
          setToastMessage(message);
          if (tg && tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
        };

        const handleStart = (participantCount) => {
          setTotalParticipants(participantCount);
          setCurrentParticipant(1);
          setResults([]);
          setCurrentPage('calculator');
          if (tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
        };

        // –î–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å dark-theme –Ω–∞ body –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã
        useEffect(() => {
          if (theme === 'dark') {
            document.body.classList.add('dark-theme');
          } else {
            document.body.classList.remove('dark-theme');
          }
        }, [theme]);

        const handleThemeChange = (newTheme) => {
          setTheme(newTheme);
          if (tg) {
            tg.setHeaderColor(newTheme === 'dark' ? '#1a0b2e' : '#fdf4ff');
            tg.setBackgroundColor(newTheme === 'dark' ? '#1a0b2e' : '#fdf4ff');
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
          }
        };

        const handleSave = (criteriaData) => {
          const totalScore = Object.values(criteriaData).reduce((sum, val) => sum + val, 0);
          const maxTotal = 100;
          const percentage = (totalScore / maxTotal) * 100;

          const newResult = {
            id: currentParticipant, criteria: criteriaData, totalScore, percentage,
          };

          setResults([...results, newResult]);

          const formatValue = (num) => num % 1 === 0 ? num.toString() : num.toFixed(1);
          showToast(`–£—á–∞—Å—Ç–Ω–∏–∫ ${currentParticipant} —Å–æ—Ö—Ä–∞–Ω–µ–Ω! –ë–∞–ª–ª: ${formatValue(totalScore)}/100`);

          if (currentParticipant < totalParticipants) {
            setCurrentParticipant(currentParticipant + 1);
          } else {
            setTimeout(() => setCurrentPage('results'), 500);
          }
        };

        const handleBack = () => {
          setCurrentPage('home');
          setCurrentParticipant(1);
          setResults([]);
          if (tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        };

        const updateCriteria = (key, value) => {
          setCriteria(prev => ({ ...prev, [key]: value }));
        };

        const toggleSection = (section) => {
          setExpandedSections(prev => ({ ...prev, [section]: !prev[section] }));
          if (tg && tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        };

        const appearanceScore = criteria.face + criteria.body + criteria.height + criteria.hair + criteria.skin + criteria.smile;
        const physicalScore = criteria.muscles + criteria.endurance + criteria.flexibility + criteria.posture;
        const charismaScore = criteria.confidence + criteria.communication + criteria.humor + criteria.charismaEnergy;
        const characterScore = criteria.kindness + criteria.honesty + criteria.empathy + criteria.reliability;

        const totalScore = appearanceScore + physicalScore + charismaScore + characterScore +
          criteria.fitness + criteria.smell + criteria.style + criteria.status;
        const maxTotal = 100;
        const percentage = (totalScore / maxTotal) * 100;

        const getRating = (percentage) => {
          if (percentage >= 90) return { text: '–í–´ –¢–†–ê–•–ê–†–¨!', color: '#a78bfa', emoji: 'üî•' };
          if (percentage >= 75) return { text: '–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–∞—Ö–∞–ª–∏—Å—å', color: '#22c55e', emoji: 'üí™' };
          if (percentage >= 65) return { text: '–ê –≤—ã –ø–æ—á—Ç–∏ –µ–±–µ—Ç–µ—Å—å', color: '#3b82f6', emoji: 'üòé' };
          if (percentage >= 50) return { text: '–í—ã —á—É—Ç—å –ª—É—á—à–µ –ñ—É–∂–Ω–µ–≤–∞', color: '#eab308', emoji: 'ü§î' };
          if (percentage >= 30) return { text: '–í—ã –ñ—É–∂–Ω–µ–≤', color: '#f59e42', emoji: 'üòÖ' };
          return { text: '–í—ã —Ö—É–∂–µ –ñ—É–∂–Ω–µ–≤–∞', color: '#ef4444', emoji: 'üíÄ' };
        };

        const rating = getRating(percentage);

        const handleSaveInternal = () => {
          handleSave(criteria);
          setCriteria({
            face: 0, body: 0, height: 0, hair: 0, skin: 0, smile: 0,
            muscles: 0, endurance: 0, flexibility: 0, posture: 0,
            confidence: 0, communication: 0, humor: 0, charismaEnergy: 0,
            kindness: 0, honesty: 0, empathy: 0, reliability: 0,
            fitness: 0, smell: 0, style: 0, status: 0,
          });
        };

        const formatValue = (num) => num % 1 === 0 ? num.toString() : num.toFixed(1);

        const calculateAverage = () => {
          if (results.length === 0) return null;
          const avgCriteria = {
            face: 0, body: 0, height: 0, hair: 0, skin: 0, smile: 0,
            muscles: 0, endurance: 0, flexibility: 0, posture: 0,
            confidence: 0, communication: 0, humor: 0, charismaEnergy: 0,
            kindness: 0, honesty: 0, empathy: 0, reliability: 0,
            fitness: 0, smell: 0, style: 0, status: 0,
          };

          results.forEach(result => {
            Object.keys(avgCriteria).forEach(key => {
              avgCriteria[key] += result.criteria[key];
            });
          });

          Object.keys(avgCriteria).forEach(key => {
            avgCriteria[key] = Math.round(avgCriteria[key] / results.length * 10) / 10;
          });

          const totalScore = Object.values(avgCriteria).reduce((sum, val) => sum + val, 0);
          const percentage = (totalScore / maxTotal) * 100;

          return { criteria: avgCriteria, totalScore: Math.round(totalScore * 10) / 10, percentage };
        };

        const average = calculateAverage();
        const sortedResults = [...results].sort((a, b) => b.totalScore - a.totalScore);

        // HOME PAGE
        if (currentPage === 'home') {
          return (
            <div style={{padding:'16px',maxWidth:'600px',margin:'0 auto'}}>
              <div style={{textAlign:'right'}}>
                <button className="button" onClick={() => handleThemeChange(theme === 'light' ? 'dark' : 'light')}>
                  {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}
                </button>
              </div>
              <div style={{textAlign:'center',margin:'32px 0'}}>
                <div className="emoji" style={{marginBottom:'16px'}}>‚ú®</div>
                <h1 style={{fontSize:'2em',fontWeight:'bold'}}>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–µ–∫—Å–∞ –¢—Ä–∞—Ö–∞—Ä—è</h1>
                <p>–£–∑–Ω–∞–π—Ç–µ –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤—ã —Ç—Ä–∞—Ö–∞—Ä—å üî•</p>
              </div>
              <div className="card">
                <div style={{textAlign:'center',marginBottom:'16px'}}>
                  <div className="emoji">üë•</div>
                  <h2 style={{fontWeight:'bold'}}>–ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å</h2>
                  <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏</p>
                </div>
                <div style={{textAlign:'center',marginBottom:'16px'}}>
                  <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</label>
                  <div>
                    <button className="button" onClick={() => setCount(Math.max(1, count - 1))}>-</button>
                    <span style={{fontSize:'2em',fontWeight:'bold',margin:'0 16px'}}>{count}</span>
                    <button className="button" onClick={() => setCount(Math.min(20, count + 1))}>+</button>
                  </div>
                </div>
                <div style={{textAlign:'center',marginBottom:'16px'}}>
                  {[1,2,5,10].map(num => (
                    <button key={num} className="button" style={count===num?{background:'#a78bfa',color:'#fff'}:{}} onClick={()=>setCount(num)}>{num}</button>
                  ))}
                </div>
                <button className="button button-main" style={{width:'100%',fontSize:'1.2em'}} onClick={()=>handleStart(count)}>
                  –ù–∞—á–∞—Ç—å –æ—Ü–µ–Ω–∫—É ‚ú®
                </button>
              </div>
              {toastMessage && (
                <div style={{position:'fixed',bottom:'24px',left:'50%',transform:'translateX(-50%)',background:'#22c55e',color:'#fff',padding:'12px 24px',borderRadius:'16px',fontWeight:'bold',zIndex:1000}}>
                  {toastMessage}
                </div>
              )}
            </div>
          );
        }

        // CALCULATOR PAGE
        if (currentPage === 'calculator') {
          return (
            <div style={{padding:'16px',maxWidth:'700px',margin:'0 auto'}}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:'16px'}}>
                <button className="button" onClick={handleBack}>‚¨Ö –ù–∞–∑–∞–¥</button>
                <div>–£—á–∞—Å—Ç–Ω–∏–∫ {currentParticipant} –∏–∑ {totalParticipants}</div>
              </div>
              <div className="card">
                <div style={{textAlign:'center'}}>
                  <div className="emoji">‚≠ê</div>
                  <h2 style={{fontWeight:'bold'}}>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–µ–∫—Å–∞ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
                  <p>–û—Ü–µ–Ω–∏—Ç–µ —Å–≤–æ–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É</p>
                  <div style={{margin:'16px 0'}}>
                    <span style={{fontSize:'2em',color:rating.color}}>{rating.emoji}</span>
                    <span style={{fontSize:'2em',fontWeight:'bold',color:rating.color,marginLeft:'8px'}}>{totalScore % 1 === 0 ? totalScore : totalScore.toFixed(1)}/{maxTotal}</span>
                  </div>
                  <div style={{fontWeight:'bold',color:rating.color}}>{rating.text}</div>
                  <div className="progress">
                    <div className="progress-bar" style={{width:percentage+'%'}}></div>
                  </div>
                  <div style={{textAlign:'center',margin:'8px 0'}}>{percentage.toFixed(1)}%</div>
                </div>
              </div>
              <div className="card">
                <h3>üíé –í–Ω–µ—à–Ω–æ—Å—Ç—å ({appearanceScore}/30)</h3>
                <SliderItem label="–õ–∏—Ü–æ" value={criteria.face} max={15} onChange={v=>updateCriteria('face',v)} />
                <SliderItem label="–ü—Ä–∏—á–µ—Å–∫–∞" value={criteria.hair} max={5} onChange={v=>updateCriteria('hair',v)} />
                <SliderItem label="–ö–æ–∂–∞" value={criteria.skin} max={5} onChange={v=>updateCriteria('skin',v)} />
                <SliderItem label="–£–ª—ã–±–∫–∞" value={criteria.smile} max={5} onChange={v=>updateCriteria('smile',v)} />
              </div>
              <div className="card">
                <h3>üí™ –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞ ({physicalScore}/20)</h3>
                <SliderItem label="–ú—ã—à—Ü—ã" value={criteria.muscles} max={4} onChange={v=>updateCriteria('muscles',v)} />
                <SliderItem label="–†–æ—Å—Ç" value={criteria.endurance} max={10} onChange={v=>updateCriteria('endurance',v)} />
                <SliderItem label="–í–µ—Å" value={criteria.flexibility} max={4} onChange={v=>updateCriteria('flexibility',v)} />
                <SliderItem label="–û—Å–∞–Ω–∫–∞" value={criteria.posture} max={2} onChange={v=>updateCriteria('posture',v)} />
              </div>
              <div className="card">
                <h3>‚ú® –•–∞—Ä–∏–∑–º–∞ ({charismaScore}/20)</h3>
                <SliderItem label="–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å" value={criteria.confidence} max={5} onChange={v=>updateCriteria('confidence',v)} />
                <SliderItem label="–ö–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å" value={criteria.communication} max={5} onChange={v=>updateCriteria('communication',v)} />
                <SliderItem label="–ß—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞" value={criteria.humor} max={5} onChange={v=>updateCriteria('humor',v)} />
                <SliderItem label="–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞" value={criteria.charismaEnergy} max={5} onChange={v=>updateCriteria('charismaEnergy',v)} />
              </div>
              <div className="card">
                <h3>‚ù§Ô∏è –•–∞—Ä–∞–∫—Ç–µ—Ä ({characterScore}/10)</h3>
                <SliderItem label="–î–æ–±—Ä–æ—Ç–∞" value={criteria.kindness} max={3} onChange={v=>updateCriteria('kindness',v)} />
                <SliderItem label="–ß–µ—Å—Ç–Ω–æ—Å—Ç—å" value={criteria.honesty} max={2} onChange={v=>updateCriteria('honesty',v)} />
                <SliderItem label="–≠–º–ø–∞—Ç–∏—è" value={criteria.empathy} max={3} onChange={v=>updateCriteria('empathy',v)} />
                <SliderItem label="–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å" value={criteria.reliability} max={2} onChange={v=>updateCriteria('reliability',v)} />
              </div>
              <div className="card">
                <h3>üèãÔ∏è –§–∏–∑–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
                <SliderItem label=" " value={criteria.fitness} max={5} onChange={v=>updateCriteria('fitness',v)} />
                <h3>üå∏ –ó–∞–ø–∞—Ö</h3>
                <SliderItem label=" " value={criteria.smell} max={5} onChange={v=>updateCriteria('smell',v)} />
                <h3>üëî –°—Ç–∏–ª—å –æ–¥–µ–∂–¥—ã</h3>
                <SliderItem label=" " value={criteria.style} max={5} onChange={v=>updateCriteria('style',v)} />
                <h3>üëë –°—Ç–∞—Ç—É—Å –≤ –æ–±—â–µ—Å—Ç–≤–µ</h3>
                <SliderItem label=" " value={criteria.status} max={5} onChange={v=>updateCriteria('status',v)} />
              </div>
              <button className="button button-main" style={{width:'100%',fontSize:'1.2em'}} onClick={handleSaveInternal}>
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚úÖ
              </button>
              <div style={{textAlign:'center',margin:'8px 0'}}>
                <p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª: {maxTotal}</p>
                <p style={{fontSize:'0.9em',color:'#888'}}>üí° –ú–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ –∏ –ø–æ–ª–æ–≤–∏–Ω–∫–∏ (0.5, 1.5, 2.5 –∏ —Ç.–¥.)</p>
              </div>
              {toastMessage && (
                <div style={{position:'fixed',bottom:'24px',left:'50%',transform:'translateX(-50%)',background:'#22c55e',color:'#fff',padding:'12px 24px',borderRadius:'16px',fontWeight:'bold',zIndex:1000}}>
                  {toastMessage}
                </div>
              )}
            </div>
          );
        }

        // RESULTS PAGE
        if (currentPage === 'results') {
          return (
            <div style={{padding:'16px',maxWidth:'700px',margin:'0 auto'}}>
              <div style={{display:'flex',justifyContent:'space-between',marginBottom:'16px'}}>
                <button className="button" onClick={handleBack}>‚¨Ö –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                <button className="button" style={showAverage?{background:'#a78bfa',color:'#fff'}:{}} onClick={()=>setShowAverage(!showAverage)}>
                  {showAverage ? '–°–∫—Ä—ã—Ç—å —Å—Ä–µ–¥–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ'}
                </button>
              </div>
              <div style={{textAlign:'center',margin:'32px 0'}}>
                <div className="emoji">üèÜ</div>
                <h2 style={{fontWeight:'bold'}}>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞</h2>
                <p>–í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {results.length}</p>
              </div>
              {showAverage && average && (
                <div className="card" style={{border:'2px solid #3b82f6'}}>
                  <div style={{display:'flex',justifyContent:'space-between'}}>
                    <div style={{display:'flex',alignItems:'center'}}>
                      <span className="emoji">üßÆ</span>
                      <span style={{fontWeight:'bold',fontSize:'1.2em',marginLeft:'8px'}}>–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</span>
                    </div>
                    <div style={{fontWeight:'bold',fontSize:'1.2em',color:getRating(average.percentage).color}}>
                      {formatValue(average.totalScore)}/{maxTotal}
                    </div>
                  </div>
                  <div style={{fontWeight:'bold',color:getRating(average.percentage).color}}>
                    {getRating(average.percentage).emoji} {getRating(average.percentage).text} - {average.percentage.toFixed(1)}%
                  </div>
                  <div className="progress">
                    <div className="progress-bar" style={{width:average.percentage+'%'}}></div>
                  </div>
                  <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:'8px'}}>
                    {/*
                      –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –º–∞—Å—Å–∏–≤ —Å —Ä—É—Å—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
                    */}
                    {/*
                      Object.entries(average.criteria).map(([key,val],idx) => (
                        <div key={key} style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px',fontSize:'0.95em'}}>
                          <span style={{fontWeight:'bold'}}>{key}</span>: {formatValue(val)}
                        </div>
                      ))
                    */}
                    {/*
                      –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞:
                      –ó–∞–º–µ–Ω–∏—Ç—å grid —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π –∞–Ω–∞–ª–æ–≥
                    */}
                    {/*
                      <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:'8px'}}>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üíé –í–Ω–µ—à–Ω–æ—Å—Ç—å: {formatValue(appearanceScore)}/30</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üí™ –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞: {formatValue(physicalScore)}/20</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>‚ú® –•–∞—Ä–∏–∑–º–∞: {formatValue(charismaScore)}/20</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>‚ù§Ô∏è –•–∞—Ä–∞–∫—Ç–µ—Ä: {formatValue(characterScore)}/10</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üèãÔ∏è –§–∏–∑. –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞: {formatValue(result.criteria.fitness)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üå∏ –ó–∞–ø–∞—Ö: {formatValue(result.criteria.smell)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üëî –°—Ç–∏–ª—å: {formatValue(result.criteria.style)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üëë –°—Ç–∞—Ç—É—Å: {formatValue(result.criteria.status)}/5</div>
                      </div>
                    */}
                  </div>
                </div>
              )}
              {sortedResults.map((result, index) => {
                const rating = getRating(result.percentage);
                const isWinner = index === 0 && results.length > 1;
                const appearanceScore = result.criteria.face + result.criteria.hair + result.criteria.skin + result.criteria.smile;
                const physicalScore = result.criteria.muscles + result.criteria.endurance + result.criteria.flexibility + result.criteria.posture;
                const charismaScore = result.criteria.confidence + result.criteria.communication + result.criteria.humor + result.criteria.charismaEnergy;
                const characterScore = result.criteria.kindness + result.criteria.honesty + result.criteria.empathy + result.criteria.reliability;
                return (
                  <div key={result.id} className="card" style={isWinner?{border:'2px solid #eab308',boxShadow:'0 0 16px #eab308'}:{}}>
                    <div style={{display:'flex',justifyContent:'space-between'}}>
                      <div style={{display:'flex',alignItems:'center'}}>
                        {isWinner && <span className="emoji">üèÜ</span>}
                        <span style={{fontWeight:'bold',fontSize:'1.2em',marginLeft:'8px'}}>–£—á–∞—Å—Ç–Ω–∏–∫ {result.id}</span>
                      </div>
                      <div style={{fontWeight:'bold',fontSize:'1.2em',color:rating.color}}>
                        {formatValue(result.totalScore)}/{maxTotal}
                      </div>
                    </div>
                    <div style={{fontWeight:'bold',color:rating.color}}>
                      {rating.emoji} {rating.text} - {result.percentage.toFixed(1)}%
                    </div>
                    <div className="progress">
                      <div className="progress-bar" style={{width:result.percentage+'%'}}></div>
                    </div>
                    <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:'8px'}}>
                      {/*
                        –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –º–∞—Å—Å–∏–≤ —Å —Ä—É—Å—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
                      */}
                      {/*
                        Object.entries(result.criteria).map(([key,val]) => (
                          <div key={key} className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px',fontSize:'0.95em'}}>
                            <span style={{fontWeight:'bold'}}>{key}</span>: {formatValue(val)}
                          </div>
                        ))
                      */}
                      {/*
                        –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞:
                        –ó–∞–º–µ–Ω–∏—Ç—å grid —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π –∞–Ω–∞–ª–æ–≥
                      */}
                      <div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:'8px'}}>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üíé –í–Ω–µ—à–Ω–æ—Å—Ç—å: {formatValue(appearanceScore)}/30</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üí™ –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞: {formatValue(physicalScore)}/20</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>‚ú® –•–∞—Ä–∏–∑–º–∞: {formatValue(charismaScore)}/20</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>‚ù§Ô∏è –•–∞—Ä–∞–∫—Ç–µ—Ä: {formatValue(characterScore)}/10</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üèãÔ∏è –§–∏–∑. –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞: {formatValue(result.criteria.fitness)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üå∏ –ó–∞–ø–∞—Ö: {formatValue(result.criteria.smell)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üëî –°—Ç–∏–ª—å: {formatValue(result.criteria.style)}/5</div>
                        <div className="result-cell" style={{background:'#f3f3f3',borderRadius:'8px',padding:'8px'}}>üëë –°—Ç–∞—Ç—É—Å: {formatValue(result.criteria.status)}/5</div>
                      </div>
                    </div>
                  </div>
                );
              })}
              {toastMessage && (
                <div style={{position:'fixed',bottom:'24px',left:'50%',transform:'translateX(-50%)',background:'#22c55e',color:'#fff',padding:'12px 24px',borderRadius:'16px',fontWeight:'bold',zIndex:1000}}>
                  {toastMessage}
                </div>
              )}
            </div>
          );
        }

        return null;
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>